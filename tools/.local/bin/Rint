#!/usr/bin/env python
import pexpect
import sys
import struct
import fcntl
import termios

def terminal_size():
	h, w, hp, wp = struct.unpack('HHHH', fcntl.ioctl(0, termios.TIOCGWINSZ, struct.pack('HHHH', 0, 0, 0, 0)))
	return h, w
default_rows, default_columns = terminal_size()

if len(sys.argv) < 2:
	print("Usage: Rint script.R [args...]")
	sys.exit(1)

rargs = sys.argv[2:]
p = pexpect.spawn("R --quiet --no-save --args "+" ".join(rargs))
p.setwinsize(default_rows, default_columns)
for l in open(sys.argv[1]):
	p.send(l)
p.interact()
